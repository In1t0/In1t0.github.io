<h1 id="80-443-Pentesting-Web-Methodology"><a href="#80-443-Pentesting-Web-Methodology" class="headerlink" title="80,443 - Pentesting Web Methodology"></a>80,443 - Pentesting Web Methodology</h1><p>If you want to <strong>know</strong> about my <strong>latest modifications</strong>/<strong>additions</strong> or you have <strong>any suggestion for HackTricks or PEASS</strong>, ****join the <a href="https://emojipedia.org/speech-balloon/" target="_blank" rel="noopener">üí¨</a> ****<a href="https://t.me/peass" target="_blank" rel="noopener"><strong>PEASS &amp; HackTricks telegram group here</strong></a>, or <strong>follow me on Twitter</strong> <a href="https://emojipedia.org/bird/" target="_blank" rel="noopener">üê¶</a><a href="https://twitter.com/carlospolopm" target="_blank" rel="noopener"><strong>@carlospolopm</strong></a><strong>.</strong><br>If you want to <strong>share some tricks with the community</strong> you can also submit <strong>pull requests</strong> to ****<a href="https://github.com/carlospolop/hacktricks" target="_blank" rel="noopener"><strong>https://github.com/carlospolop/hacktricks</strong></a> ****that will be reflected in this book.<br>Don‚Äôt forget to <strong>give ‚≠ê on the github</strong> to motivate me to continue developing this book.</p>
<h2 id="Basic-Info"><a href="#Basic-Info" class="headerlink" title="Basic Info"></a>Basic Info</h2><p>The web service is the most <strong>common and extensive service</strong> and a lot of <strong>different types of vulnerabilities</strong> exists.</p>
<p><strong>Default port:</strong> 80 (HTTP), 443(HTTPS)</p>
<pre><code class="bash">PORT    STATE SERVICE
80/tcp  open  http
443/tcp open  ssl/https
</code></pre>
<pre><code class="bash">nc -v domain.com 80 # GET / HTTP/1.0
openssl s_client -connect domain.com:443 # GET / HTTP/1.0
</code></pre>
<h2 id="Methodology-summary"><a href="#Methodology-summary" class="headerlink" title="Methodology summary"></a>Methodology summary</h2><blockquote>
<p>In this methodology we are going to suppose that you are going to a attack a domain (or subdomain) and only that. So, you should apply this methodology to each discovered domain, subdomain or IP with undetermined web server inside the scope.</p>
</blockquote>
<ul>
<li><input disabled="" type="checkbox"> Start by <strong>identifying</strong> the <strong>technologies</strong> used by the web server. Look for <strong>tricks</strong> to keep in mind during the rest of the test if you can successfully identify the tech.<ul>
<li><input disabled="" type="checkbox"> Any <strong>known vulnerability</strong> of the version of the technology?</li>
<li><input disabled="" type="checkbox"> Using any <strong>well known tech</strong>? Any <strong>useful trick</strong> to extract more information?</li>
<li><input disabled="" type="checkbox"> Any <strong>specialised scanner</strong> to run (like wpscan)?</li>
<li><input disabled="" type="checkbox"> Any <strong>vulnerable cookie</strong>? <strong>JWT</strong>?</li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Check for <strong>vulnerable proxies</strong> being used (_Test this in every new tech discovered in the webapp_) :<ul>
<li><input disabled="" type="checkbox"> <strong>hop-by-hop headers</strong></li>
<li><input disabled="" type="checkbox"> <strong>Request Smuggling</strong></li>
<li><input disabled="" type="checkbox"> <strong>Cache Poisoning/Cache Deception</strong></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> Launch <strong>general purposes scanners</strong>. You never know if they are going to find something or if the are going to find some interesting information.</li>
<li><input disabled="" type="checkbox"> Start with the <strong>initial checks</strong>: <strong>robots</strong>, <strong>sitemap</strong>, <strong>404</strong> error and <strong>SSL/TLS scan</strong> (if HTTPS).</li>
<li><input disabled="" type="checkbox"> Start <strong>spidering</strong> the web page: It‚Äôs time to <strong>find</strong> all the possible <strong>files, folders</strong> and <strong>parameters being used.</strong> Also, check for <strong>special findings</strong>.<ul>
<li><input disabled="" type="checkbox"> <em>Note that anytime a new directory is discovered during brute-forcing or spidering, it should be spidered.</em></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> <strong>Directory Brute-Forcing</strong>: Try to brute force all the discovered folders searching for new <strong>files</strong> and <strong>directories</strong>. <ul>
<li><input disabled="" type="checkbox"> <em>Note that anytime a new directory is discovered during brute-forcing or spidering, it should be Brute-Forced.</em></li>
</ul>
</li>
<li><input disabled="" type="checkbox"> <strong>Backups checking</strong>: Test if you can find <strong>backups</strong> of <strong>discovered files</strong> appending common backup extensions.</li>
<li><input disabled="" type="checkbox"> <strong>Brute-Force parameters</strong>: Try to <strong>find hidden parameters</strong>.</li>
<li><input disabled="" type="checkbox"> Once you have <strong>identified</strong> all the possible <strong>endpoints</strong> accepting <strong>user input</strong>, check for all kind of <strong>vulnerabilities</strong> related to it.<ul>
<li><input disabled="" type="checkbox"> This is by far the <strong>most complex part of pentesting web</strong>, and <strong>depending</strong> of the <strong>vulnerability</strong> the pentester should know how to <strong>discover</strong> it. In <strong>this book</strong> you can find <strong>explained</strong> a lot of <strong>web vulnerabilities</strong> related to user input.</li>
</ul>
</li>
</ul>
<h2 id="Server-Version-Vulnerable"><a href="#Server-Version-Vulnerable" class="headerlink" title="Server Version (Vulnerable?)"></a>Server Version (Vulnerable?)</h2><h3 id="Identify"><a href="#Identify" class="headerlink" title="Identify"></a>Identify</h3><p>Check if there are <strong>known vulnerabilities</strong> for the server <strong>version</strong> that is running.<br>The <strong>HTTP headers and cookies of the response</strong> could be very useful to <strong>identify</strong> the <strong>technologies</strong> and/or <strong>version</strong> being used. <strong>Nmap scan</strong> can identify the server version, but it could also be useful the tools <a href="https://github.com/urbanadventurer/WhatWeb" target="_blank" rel="noopener"><strong>whatweb</strong></a><strong>,</strong> <a href="https://github.com/ShielderSec/webtech" target="_blank" rel="noopener"><strong>webtech</strong> </a>or <a href="https://builtwith.com/" target="_blank" rel="noopener"><strong>https://builtwith.com/</strong></a><strong>:</strong></p>
<pre><code class="bash">whatweb -a 1 &lt;URL&gt; #Stealthy
whatweb -a 3 &lt;URL&gt; #Aggresive
webtech -u &lt;URL&gt;
</code></pre>
<p>Search ****for ****<a href="../../search-exploits.md"><strong>vulnerabilities of the web application</strong> <strong>version</strong></a>****</p>
<h3 id="Cookies"><a href="#Cookies" class="headerlink" title="Cookies"></a><strong>Cookies</strong></h3><p>As commented the cookies can be very useful to identify the technology in used (if well known) but if the used <strong>cookies</strong> are <strong>custom</strong>, they could be <strong>vulnerable</strong>. So if you find a <strong>custom sensitive</strong> cookie you should <a href="../../pentesting-web/hacking-with-cookies.md#hacking-cookies"><strong>check it for vulnerabilities</strong></a>.<br>Also, the <a href="../../pentesting-web/hacking-with-cookies.md#cookies-flags"><strong>flags of the cookies</strong></a> can also be interesting from a security point of view.</p>
<h3 id="Web-tech-tricks"><a href="#Web-tech-tricks" class="headerlink" title="Web tech tricks"></a>Web tech tricks</h3><p>Some <strong>tricks</strong> for <strong>finding vulnerabilities</strong> in different well known <strong>technologies</strong> being used: </p>
<ul>
<li><a href="iis-internet-information-services.md"><strong>IIS tricks</strong></a>****</li>
<li><a href="php-tricks-esp/"><strong>PHP (php has a lot of interesting tricks that could be exploited)</strong></a>****</li>
<li>****<a href="nginx.md"><strong>Nginx</strong></a>****</li>
<li>****<a href="python.md"><strong>Python</strong></a>****</li>
<li>****<a href="flask.md"><strong>Flask</strong></a>****</li>
<li>****<a href="put-method-webdav.md"><strong>WebDav</strong></a>****</li>
<li>****<a href="cgi.md"><strong>CGI</strong></a>****</li>
<li><a href="tomcat.md"><strong>Tomcat</strong></a>****</li>
<li>****<a href="jenkins.md"><strong>Jenkins</strong></a>****</li>
<li>****<a href="jboss.md"><strong>JBOSS</strong></a>****</li>
<li>****<a href="jira.md"><strong>JIRA</strong></a></li>
<li><a href="jsp.md"><strong>JSP</strong></a>****</li>
<li>****<a href="wordpress.md"><strong>Wordpress</strong></a>****</li>
<li>****<a href="drupal.md"><strong>Drupal</strong></a>****</li>
<li>****<a href="vmware-esx-vcenter....md"><strong>VMWare (EXS, VCenter‚Ä¶)</strong></a>****</li>
<li>****<a href="graphql.md"><strong>GraphQL</strong></a>****</li>
</ul>
<p>If the <strong>source code</strong> of the application is available in <strong>github</strong>, apart of performing by y<strong>our own a White box test</strong> of the application (no guide available yet in hacktricks) there is <strong>some information</strong> that could be <strong>useful</strong> for the current <strong>Black-Box testing</strong>:</p>
<ul>
<li>Is there a <strong>Changelog or Readme or Version</strong> file or anything with <strong>version info accesible</strong> via web?</li>
<li>How and where are saved the <strong>credentials</strong>? Is there any (accesible?) <strong>file</strong> with credentials (usernames or passwords)?</li>
<li>Are <strong>passwords</strong> in <strong>plain text</strong>, <strong>encrypted</strong> or which <strong>hashing algorithm</strong> is used?</li>
<li>Is it using any <strong>master key</strong> for encrypting something? Which <strong>algorithm</strong> is used?</li>
<li>Can you <strong>access any of these files</strong> exploiting some vulnerability?</li>
<li>Is there any <strong>interesting information in the github</strong> (solved and not solved) <strong>issues</strong>? Or in <strong>commit history</strong> (maybe some <strong>password introduced inside an old commit</strong>)?</li>
</ul>
<p>_Take into account that the <strong>same domain</strong> can be using <strong>different technologies</strong> in different <strong>ports</strong>, <strong>folders</strong> and <strong>subdomains</strong>._<br>If the web application is using any well known <strong>tech/platform listed before</strong> or <strong>any other</strong>, don‚Äôt forget to <strong>search on the Internet</strong> new tricks (and let me know!).</p>
<h2 id="Proxies-Load-balances-vulnerabilities"><a href="#Proxies-Load-balances-vulnerabilities" class="headerlink" title="Proxies/Load balances vulnerabilities"></a>Proxies/Load balances vulnerabilities</h2><p>You should look for these kind of vulnerabilities every time you find a <strong>path</strong> were a <strong>different technology</strong> is <strong>running</strong>. For example, if you find a <strong>java</strong> webapp and in <code>/wordpress</code> a <strong>wordpress</strong> is running.</p>
<ul>
<li><a href="../../pentesting-web/abusing-hop-by-hop-headers.md"><strong>Abusing hop-by-hop headers</strong></a>****</li>
<li>****<a href="../../pentesting-web/http-request-smuggling.md"><strong>Request Smuggling</strong></a>****</li>
<li>****<a href="../../pentesting-web/cache-deception.md"><strong>Cache Poisoning / Cache Deception</strong></a>****</li>
</ul>
<h2 id="Automatic-scanners"><a href="#Automatic-scanners" class="headerlink" title="Automatic scanners"></a>Automatic scanners</h2><h3 id="General-purpose-automatic-scanners"><a href="#General-purpose-automatic-scanners" class="headerlink" title="General purpose automatic scanners"></a>General purpose automatic scanners</h3><pre><code class="bash">nikto -h &lt;URL&gt;
whatweb -a 4 &lt;URL&gt;
wapiti -u &lt;URL&gt;
W3af
</code></pre>
<h3 id="CMS-scanners"><a href="#CMS-scanners" class="headerlink" title="CMS scanners"></a>CMS scanners</h3><p>If a CMS is used don‚Äôt forget to <strong>run a scanner</strong>, maybe something juicy is found:</p>
<p><a href="https://github.com/hatRiot/clusterd" target="_blank" rel="noopener"><strong>Clusterd</strong></a><strong>:</strong> <a href="jboss.md"><strong>JBoss</strong></a><strong>, ColdFusion, WebLogic,</strong> <a href="tomcat.md"><strong>Tomcat</strong></a><strong>, Railo, Axis2, Glassfish</strong><br><a href="https://github.com/ajinabraham/CMSScan" target="_blank" rel="noopener"><strong>CMSScan</strong></a>: <a href="wordpress.md"><strong>WordPress</strong></a>, <a href="drupal.md"><strong>Drupal</strong></a>, <strong>Joomla</strong>, <strong>vBulletin</strong> websites for Security issues. (GUI)<br><a href="https://github.com/anouarbensaad/vulnx" target="_blank" rel="noopener"><strong>VulnX</strong></a><strong>: Joomla,</strong> <a href="wordpress.md"><strong>Wordpress</strong></a><strong>,</strong> <a href="drupal.md"><strong>Drupal</strong></a><strong>, PrestaShop, Opencart<br>CMSMap</strong>: <a href="wordpress.md"><strong>(W)ordpress</strong></a><strong>, (J)oomla,</strong> <a href="drupal.md"><strong>(D)rupal</strong></a> <strong>or (M)oodle</strong><br><a href="https://github.com/droope/droopescan" target="_blank" rel="noopener"><strong>droopscan</strong></a><strong>:</strong> <a href="drupal.md"><strong>Drupal</strong></a><strong>, Joomla, Moodle, Silverstripe,</strong> <a href="wordpress.md"><strong>Wordpress</strong></a>****</p>
<pre><code class="bash">cmsmap [-f W] -F -d &lt;URL&gt;
wpscan --force update -e --url &lt;URL&gt;
joomscan --ec -u &lt;URL&gt;
joomlavs.rb #https://github.com/rastating/joomlavs
</code></pre>
<blockquote>
<p>At this point you should already have some information of the web server being used by the client (if any data is given) and some tricks to keep in mind during the test. If you are lucky you have even found a CMS and run some scanner.</p>
</blockquote>
<h2 id="Step-by-step-Web-Application-testing"><a href="#Step-by-step-Web-Application-testing" class="headerlink" title="Step-by-step Web Application testing"></a>Step-by-step Web Application testing</h2><blockquote>
<p>From this point we are going to start interacting with the web application.</p>
</blockquote>
<h3 id="Initial-checks"><a href="#Initial-checks" class="headerlink" title="Initial checks"></a>Initial checks</h3><h4 id="Default-pages-with-interesting-info"><a href="#Default-pages-with-interesting-info" class="headerlink" title="Default pages with interesting info:"></a>Default pages with interesting info:</h4><ul>
<li>/robots.txt</li>
<li>/sitemap.xml</li>
<li>Some <em>404</em> error - <em>Some interesting data could be presented here.</em></li>
</ul>
<h4 id="Check-if-you-can-upload-files-PUT-verb-WebDav"><a href="#Check-if-you-can-upload-files-PUT-verb-WebDav" class="headerlink" title="Check if you can upload files (PUT verb, WebDav)"></a>Check if you can upload files (<a href="put-method-webdav.md">PUT verb, WebDav</a>)</h4><p>If you find that <strong>WebDav</strong> is <strong>enabled</strong> but you don‚Äôt have enough permissions for <strong>uploading files</strong> in the root folder try to:</p>
<ul>
<li><strong>Brute Force</strong> credentials</li>
<li><strong>Upload files</strong> via WebDav to the <strong>rest</strong> of <strong>found folders</strong> inside the web page. You may have permissions to upload files in other folders.</li>
</ul>
<h4 id="SSL-TLS-vulnerabilites"><a href="#SSL-TLS-vulnerabilites" class="headerlink" title="SSL/TLS vulnerabilites"></a>SSL/TLS vulnerabilites</h4><p>Use <a href="https://github.com/drwetter/testssl.sh" target="_blank" rel="noopener"><strong>testssl.sh</strong></a> to checks for <strong>vulnerabilities</strong> (In Bug Bounty programs probably these kind of vulnerabilities won‚Äôt be accepted) and use <a href="https://github.com/hahwul/a2sv" target="_blank" rel="noopener"><strong>a2sv</strong> </a>to recheck the vulnerabilities:</p>
<pre><code class="bash">./testssl.sh [--htmlfile] 10.10.10.10:443
#Use the --htmlfile to save the output inside an htmlfile also

## You can also use other tools, by testssl.sh at this momment is the best one (I think)
sslscan &lt;host:port&gt;
sslyze --regular &lt;ip:port&gt;
</code></pre>
<p>Information about SSL/TLS vulnerabilities:</p>
<ul>
<li><a href="https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/" target="_blank" rel="noopener">https://www.gracefulsecurity.com/tls-ssl-vulnerabilities/</a> </li>
<li><a href="https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/" target="_blank" rel="noopener">https://www.acunetix.com/blog/articles/tls-vulnerabilities-attacks-final-part/</a></li>
</ul>
<h3 id="Spidering"><a href="#Spidering" class="headerlink" title="Spidering"></a>Spidering</h3><p>Launch some kind of <strong>spider</strong> inside the web. The goal of the spider is:</p>
<ul>
<li>Find all <strong>files</strong> and <strong>folders</strong> (<a href="https://github.com/jaeles-project/gospider" target="_blank" rel="noopener"><strong>gospider</strong></a><strong>,</strong> <a href="https://github.com/Nekmo/dirhunt" target="_blank" rel="noopener"><strong>dirhunt</strong></a><strong>,</strong> <a href="https://github.com/saeeddhqan/evine" target="_blank" rel="noopener"><strong>envie</strong></a>). <a href="https://github.com/stevenvachon/broken-link-checker" target="_blank" rel="noopener">Broken link checker</a> (lets see if you can takeover something). You can also find links using <a href="https://github.com/IAmStoxe/urlgrab" target="_blank" rel="noopener"><strong>urlgrab</strong></a>, which supports JS rendering.</li>
<li>Find all <strong>possible parameters</strong> for each executable file. You can help yourself in this matter using <a href="https://github.com/devanshbatham/ParamSpider" target="_blank" rel="noopener">ParamSpider</a>.</li>
<li>Read the next section ‚Äú<strong>Special Findings</strong>‚Äú to search for more information on each file found.</li>
<li><a href="https://github.com/hakluke/hakrawler" target="_blank" rel="noopener">hakrawler</a> can also be interesting</li>
</ul>
<p><em>Note that anytime a new directory is discovered during brute-forcing or spidering, it should be spidered.</em></p>
<h3 id="Brute-Force-directories-and-files"><a href="#Brute-Force-directories-and-files" class="headerlink" title="Brute Force directories and files"></a>Brute Force directories and files</h3><p>Start <strong>brute-forcing</strong> from the root folder and be sure to brute-force <strong>all</strong> the <strong>directories found</strong> using <strong>this method</strong> and all the directories <strong>discovered</strong> by the <strong>Spidering</strong> (you can do this brute-forcing <strong>recursively</strong> and appending at the beginning of the used wordlist the names of the found directories).<br>Tools:</p>
<ul>
<li><strong>Dirb</strong> / <strong>Dirbuster</strong> - Included in Kali, <strong>old</strong> (and <strong>slow</strong>) but functional. Allow auto-signed certificates and recursive search.</li>
<li><a href="https://github.com/maurosoria/dirsearch" target="_blank" rel="noopener"><strong>Dirsearch</strong></a> ****- <strong>Fast</strong>, it doesn‚Äôt allow auto-signed certificates but <strong>allows recursive</strong> search.</li>
<li><a href="https://github.com/OJ/gobuster" target="_blank" rel="noopener"><strong>Gobuster</strong></a> - <strong>Fast</strong>, go needed, allow auto-signed certificates, it <strong>doesn‚Äôt</strong> have <strong>recursive</strong> search.</li>
<li><a href="https://github.com/ffuf/ffuf" target="_blank" rel="noopener"><strong>ffuf</strong> </a>- Fastest: <code>ffuf -c -w /usr/share/wordlists/dirb/big.txt -u http://10.10.10.10/FUZZ</code></li>
</ul>
<p><strong>Recommended dictionaries:</strong></p>
<ul>
<li>****<a href="https://github.com/danielmiessler/RobotsDisallowed" target="_blank" rel="noopener">https://github.com/danielmiessler/RobotsDisallowed</a> (Very interesting)</li>
<li><strong>Dirsearch</strong> included dictionary</li>
<li><a href="http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10" target="_blank" rel="noopener">http://gist.github.com/jhaddix/b80ea67d85c13206125806f0828f4d10</a></li>
<li><em>/usr/share/wordlists/dirb/common.txt</em></li>
<li><em>/usr/share/wordlists/dirb/big.txt</em></li>
<li><em>/usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt</em></li>
</ul>
<p><em>Note that anytime a new directory is discovered during brute-forcing or spidering, it should be Brute-Forced.</em></p>
<h3 id="File-backups"><a href="#File-backups" class="headerlink" title="File backups"></a>File backups</h3><p>Once you have found all the files, look for backups of all the executable files (‚Äú<em>.php</em>‚Äú, ‚Äú<em>.aspx</em>‚Äú‚Ä¶). Common variations for naming a backup are: <em>file.ext~, #file.ext#, ~file.ext, file.ext.bak, file.ext.tmp, file.ext.old, file.bak, file.tmp and file.old</em></p>
<h3 id="Discover-parameters-using-brute-force"><a href="#Discover-parameters-using-brute-force" class="headerlink" title="Discover parameters using brute-force"></a>Discover parameters using brute-force</h3><p>You use tools like ****<a href="https://github.com/s0md3v/Arjun" target="_blank" rel="noopener"><strong>Arjun</strong></a> <strong>and</strong> <a href="https://github.com/maK-/parameth" target="_blank" rel="noopener"><strong>Parameth</strong></a> to discover hidden parameters. If you can, you could try to search <strong>hidden parameters</strong> on each executable web file.</p>
<h3 id="Special-findings"><a href="#Special-findings" class="headerlink" title="Special findings"></a>Special findings</h3><p><strong>While</strong> performing the <strong>spidering</strong> and <strong>brute-forcing</strong> you could find <strong>interesting</strong> <strong>things</strong> that you have to <strong>notice</strong>.</p>
<h4 id="Interesting-files"><a href="#Interesting-files" class="headerlink" title="Interesting files"></a><strong>Interesting files</strong></h4><ul>
<li>Look for <strong>links</strong> to other files inside the <strong>CSS</strong> files.</li>
<li><a href="git.md">If you find a <em><strong>.git</strong></em> file some information can be extracted</a></li>
<li>If you find <strong>API endpoints</strong> you <a href="api-pentesting.md">should also test them</a>. These aren‚Äôt files, but will probably ‚Äúlook like‚Äù them.</li>
</ul>
<h4 id="Interesting-info-inside-the-file"><a href="#Interesting-info-inside-the-file" class="headerlink" title="Interesting info inside the file"></a><strong>Interesting info inside the file</strong></h4><ul>
<li><strong>Comments:</strong> Check the comments of all the files, you can find <strong>credentials</strong> or <strong>hidden functionality</strong>. <ul>
<li>If you are playing  <strong>CTF</strong>,  a ‚Äúcommon‚Äù trick is to <strong>hide</strong> <strong>information</strong> inside comments at the <strong>right</strong> of the <strong>page</strong> (using <strong>hundreds</strong> of <strong>spaces</strong> so you don‚Äôt see the data if you open the source code with the browser). Other possibility is to use <strong>several new lines</strong> and <strong>hide information</strong> in a comment at the <strong>bottom</strong> of the web page.</li>
</ul>
</li>
<li><strong>API keys</strong>: If you find any API key there is guide that indicates how to use API keys of different platforms: <a href="https://github.com/streaak/keyhacks" target="_blank" rel="noopener">https://github.com/streaak/keyhacks</a>, <a href="https://github.com/xyele/zile.git" target="_blank" rel="noopener">https://github.com/xyele/zile.git</a></li>
<li><strong>S3 Buckets</strong>: While spidering look if any <strong>subdomain</strong> or any <strong>link</strong> is related with some <strong>S3 bucket</strong>. In that case, <a href="buckets/"><strong>check</strong> the <strong>permissions</strong> of the bucket</a>.</li>
</ul>
<h4 id="JS-code"><a href="#JS-code" class="headerlink" title="JS code"></a>JS code</h4><p>The <strong>JS code</strong> of a web application can be really interesting: It could contain <strong>API keys</strong>, <strong>credentials</strong>, other <strong>endpoints</strong>, and understanding it you could be able to <strong>bypass security measures</strong>.<br>It could be also very useful to <strong>parse</strong> the <strong>JS files</strong> in order to search for other <strong>endpoints:</strong> <a href="https://github.com/GerbenJavado/LinkFinder" target="_blank" rel="noopener"><strong>LinkFinder</strong></a><strong>,</strong> <a href="https://github.com/dark-warlord14/JSScanner" target="_blank" rel="noopener"><strong>JSScanner</strong></a> <strong>(wrap of LinkFinder),</strong> <a href="https://github.com/nahamsec/JSParser" target="_blank" rel="noopener"><strong>JSParser</strong></a><strong>,</strong> <a href="https://github.com/jobertabma/relative-url-extractor" target="_blank" rel="noopener"><strong>relative-url-extractor</strong></a><strong>.</strong><br>Another interesting approach could be <strong>monitoring the JS files</strong> with a tool like <a href="https://github.com/robre/jsmon" target="_blank" rel="noopener"><strong>JSMon</strong></a> that checks for changes.<br>You should also <strong>check</strong> if the application is using any <strong>outdated</strong> and <strong>vulnerable javascript library</strong> with: <a href="https://github.com/retirejs/retire.js/" target="_blank" rel="noopener"><strong>RetireJS</strong></a>****</p>
<p>If the <strong>javascript</strong> code is <strong>obfuscated</strong>, these tools could be useful: </p>
<ul>
<li><strong>Javascript Deobfuscator and Unpacker</strong> (<a href="https://lelinhtinh.github.io/de4js/" target="_blank" rel="noopener">https://lelinhtinh.github.io/de4js/</a>)</li>
<li><strong>Javascript Beautifier</strong>  (<a href="https://beautifier.io/" target="_blank" rel="noopener">http://jsbeautifier.org/</a>)</li>
<li><strong>BrainFuck deobfuscation</strong> (javascript with chars:‚Äù[]!+‚Äù <a href="https://ooze.ninja/javascript/poisonjs/" target="_blank" rel="noopener">https://ooze.ninja/javascript/poisonjs/</a>)</li>
</ul>
<p>In several occasions you will need to <strong>understand regular expressions</strong> used, this will be useful: <a href="https://regex101.com/" target="_blank" rel="noopener">https://regex101.com/</a></p>
<h4 id="403-Forbidden-Basic-Authentication-401-Unauthorized-bypass"><a href="#403-Forbidden-Basic-Authentication-401-Unauthorized-bypass" class="headerlink" title="403 Forbidden/Basic Authentication/401 Unauthorized (bypass)"></a>403 Forbidden/Basic Authentication/401 Unauthorized (bypass)</h4><ul>
<li><p>Try using <strong>different verbs</strong> to access the file: <em>GET, POST, INVENTED</em></p>
</li>
<li><p>If <em>/path</em> is blocked, try using <em><strong>/</strong>_<strong>%2e/<strong>path __(if the access is blocked by a proxy, this could bypass the protection). Try also _/</strong>%252e</strong>/path</em> (double URL encode)</p>
</li>
<li><p>Try Unicode bypass: <em>/<strong>%ef%bc%8f</strong>path</em> (The URL encoded chars are like ‚Äú/‚Äú) so when encoded back it will be <em>//path</em> and maybe you will have already bypassed the <em>/path</em> name check</p>
</li>
<li><p>Try to <strong>stress the server</strong> sending common GET requests (<a href="https://medium.com/@amineaboud/story-of-a-weird-vulnerability-i-found-on-facebook-fc0875eb5125" target="_blank" rel="noopener">It worked for this guy wit Facebook</a>).</p>
</li>
<li><p><strong>Other path bypasses</strong>:</p>
<ul>
<li>site.com/secret ‚Äì&gt; HTTP 403 Forbidden</li>
<li>site.com/SECRET ‚Äì&gt; HTTP 200 OK</li>
<li>site.com/secret/ ‚Äì&gt; HTTP 200 OK</li>
<li>site.com/secret/. ‚Äì&gt; HTTP 200 OK</li>
<li>site.com//secret// ‚Äì&gt; HTTP 200 OK</li>
<li>site.com/./secret/.. ‚Äì&gt; HTTP 200 OK</li>
<li>site.com/secret.json ‚Äì&gt; HTTP 200 OK (ruby)</li>
</ul>
</li>
<li><p><strong>Other bypasses:</strong></p>
<ul>
<li>/v3/users_data/1234 ‚Äì&gt; 403 Forbidden </li>
<li>/v1/users_data/1234 ‚Äì&gt; 200 OK</li>
<li>{‚Äúid‚Äù:111} ‚Äì&gt; 401 Unauthriozied</li>
<li>{‚Äúid‚Äù:[111]} ‚Äì&gt; 200 OK</li>
<li>{‚Äúid‚Äù:111} ‚Äì&gt; 401 Unauthriozied</li>
<li>{‚Äúid‚Äù:{‚Äúid‚Äù:111}} ‚Äì&gt; 200 OK</li>
<li>{‚Äúuser_id‚Äù:‚Äù&lt;legit_id&gt;‚Äù,‚Äùuser_id‚Äù:‚Äù&lt;victims_id&gt;‚Äù} (JSON Parameter Pollution)</li>
<li>user_id=ATTACKER_ID&amp;user_id=VICTIM_ID (Parameter Pollution)</li>
</ul>
</li>
<li><p>Go to <a href="https://archive.org/web/" target="_blank" rel="noopener">https://archive.org/web/</a> and check if in the past that file was <strong>worldwide accessible</strong>.</p>
</li>
<li><p><strong>Fuzz the page</strong>: Try using HTTP Proxy <strong>Headers</strong>, HTTP Authentication Basic and NTLM brute-force (with a few combinations only) and other techniques. To do all of this I have created the tool <a href="https://github.com/carlospolop/fuzzhttpbypass" target="_blank" rel="noopener"><strong>fuzzhttpbypass</strong></a>.</p>
<ul>
<li><code>X-Originating-IP: 127.0.0.1</code> </li>
<li><code>X-Forwarded-For: 127.0.0.1</code> </li>
<li><code>X-Remote-IP: 127.0.0.1</code> </li>
<li><code>X-Remote-Addr: 127.0.0.1</code></li>
<li><code>X-ProxyUser-Ip: 127.0.0.1</code></li>
<li><code>X-Original-URL: 127.0.0.1</code></li>
<li>If the <strong>path is protected</strong> you can try to bypass the path protection using these other headers:<ul>
<li><code>X-Original-URL: /admin/console</code></li>
<li><code>X-Rewrite-URL: /admin/console</code></li>
</ul>
</li>
</ul>
</li>
<li><p><strong>Guess the password</strong>: Test the following common credentials. Do you know something about the victim? Or the CTF challenge name?</p>
</li>
<li><p><a href="../../brute-force.md#http-brute"><strong>Brute force</strong></a></p>
<p>Common creds</p>
<pre><code class="text">admin    admin
admin    password
admin    1234
admin    admin1234
admin    123456
root     toor
test     test
guest    guest
</code></pre>
</li>
</ul>
<h4 id="502-Proxy-Error"><a href="#502-Proxy-Error" class="headerlink" title="502 Proxy Error"></a>502 Proxy Error</h4><p>If any page <strong>responds</strong> with that <strong>code</strong>, it‚Äôs probably a <strong>bad configured proxy</strong>. ****If you send a HTTP request like: <code>GET https://google.com HTTP/1.1</code> (with the host header and other common headers), the <strong>proxy</strong> will try to <strong>access</strong> _<strong>google.com</strong>_ and you will have found a <strong>SSRF</strong>.</p>
<h4 id="NTLM-Authentication-Info-disclosure"><a href="#NTLM-Authentication-Info-disclosure" class="headerlink" title="NTLM Authentication - Info disclosure"></a><strong>NTLM Authentication - Info disclosure</strong></h4><p>If the running server asking for authentication is <strong>Windows</strong> or you find a login asking for your <strong>credentials</strong> (and asking for <strong>domain</strong> <strong>name</strong>), you can provoke an <strong>information disclosure</strong>.<br><strong>Send</strong> the <strong>header</strong>: <code>‚ÄúAuthorization: NTLM TlRMTVNTUAABAAAAB4IIAAAAAAAAAAAAAAAAAAAAAAA=‚Äù</code> and due to how the <strong>NTLM authentication works</strong>, the server will respond with internal info (IIS version, Windows version‚Ä¶) inside the header ‚ÄúWWW-Authenticate‚Äù.<br>You can <strong>automate</strong> this using the <strong>nmap plugin</strong> ‚Äú<em>http-ntlm-info.nse</em>‚Äú. </p>
<h4 id="HTTP-Redirect-CTF"><a href="#HTTP-Redirect-CTF" class="headerlink" title="HTTP Redirect (CTF)"></a>HTTP Redirect (CTF)</h4><p>It is possible to <strong>put content</strong> inside a <strong>Redirection</strong>. This content <strong>won‚Äôt be shown to the user</strong> (as the browser will execute the redirection) but something could be <strong>hidden</strong> in there.</p>
<h2 id="User-input-related-vulnerabilities-special-mention"><a href="#User-input-related-vulnerabilities-special-mention" class="headerlink" title="User input related vulnerabilities special mention"></a>User input related vulnerabilities special mention</h2><h3 id="Bypass-regular-login-POST-or-GET-method"><a href="#Bypass-regular-login-POST-or-GET-method" class="headerlink" title="Bypass regular login (POST or GET method)"></a><strong>Bypass regular login (POST or GET method)</strong></h3><p>If you find a login page, here you can find some techniques to try to bypass it:</p>
<ul>
<li>Check for <strong>comments</strong> inside the page (scroll down and to the right?)</li>
<li>Check if you can <strong>directly access the restricted pages</strong></li>
<li>Check to <strong>not send the parameters</strong> (do not send any or only 1)</li>
<li>Test manually <a href="./#2-2-5-list-of-common-password-to-test-manually">very common passwords</a>.</li>
<li>Check for <strong>default credentials</strong> </li>
<li>Check for <strong>common combinations</strong> (root, admin, password, name of the tech, default user with one of these passwords)</li>
<li>Check the <strong>PHP comparisons error:</strong> <em>user[]=a&amp;pwd=b</em> , <em>user=a&amp;pwd[]=b</em> , <em>user[]=a&amp;pwd[]=b</em></li>
<li>Create a dictionary using <strong>Cewl</strong>, <strong>add</strong> the <strong>default</strong> username and password (if there is) and try to brute-force it using all the words as <strong>usernames and password</strong></li>
<li>Try to <strong>brute-force</strong> using a bigger <strong>dictionary (</strong><a href="../../brute-force.md#http-post-form"><strong>Brute force</strong></a><strong>)</strong></li>
</ul>
<p>You should also check for:</p>
<ul>
<li><a href="../../pentesting-web/sql-injection/#authentication-bypass"><strong>SQL Injection authentication bypass</strong></a>****</li>
<li>****<a href="../../pentesting-web/nosql-injection.md"><strong>NoSQL Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/xpath-injection.md"><strong>XPath Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/ldap-injection.md"><strong>LDAP Injection</strong></a>****</li>
</ul>
<h3 id="Insert-into-Create-Object"><a href="#Insert-into-Create-Object" class="headerlink" title="Insert into/Create Object"></a>Insert into/Create Object</h3><p>Check for ****<a href="../../pentesting-web/sql-injection/#insert-statement"><strong>SQL INSERT INTO Injections.</strong></a>****</p>
<h3 id="Upload-Files"><a href="#Upload-Files" class="headerlink" title="Upload Files"></a><strong>Upload Files</strong></h3><p>Check for this vulnerabilities:</p>
<ul>
<li>****<a href="../../pentesting-web/file-upload/"><strong>File Upload</strong></a>****</li>
</ul>
<h2 id="User-input-Web-Vulnerabilities-list"><a href="#User-input-Web-Vulnerabilities-list" class="headerlink" title="User input Web Vulnerabilities list"></a><strong>User input Web Vulnerabilities list</strong></h2><ul>
<li>****<a href="../../pentesting-web/2fa-bypass.md"><strong>2FA Bypass</strong></a>****</li>
<li>****<a href="../../pentesting-web/captcha-bypass.md"><strong>Captcha Bypass</strong></a>****</li>
<li>****<a href="../../pentesting-web/clickjacking.md"><strong>Clickjacking</strong></a>****</li>
<li>****<a href="../../pentesting-web/client-side-template-injection-csti.md"><strong>Client Side Template Injection (CSTI)</strong></a>****</li>
<li>****<a href="../../pentesting-web/command-injection.md"><strong>Command Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/content-security-policy-csp-bypass.md"><strong>Content Security Policy (CSP) Bypass</strong></a>****</li>
<li>****<a href="../../pentesting-web/hacking-with-cookies.md"><strong>Cookies Hacking</strong></a>****</li>
<li>****<a href="../../pentesting-web/cors-bypass.md"><strong>CORS - Misconfigurations &amp; Bypass</strong></a>****</li>
<li>****<a href="../../pentesting-web/crlf-0d-0a.md"><strong>CRLF Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/csrf-cross-site-request-forgery.md"><strong>CSRF (Cross Site Request Forgery)</strong></a>****</li>
<li>****<a href="../../pentesting-web/dangling-markup-html-scriptless-injection.md"><strong>Dangling Markup - HTML scriptless injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/deserialization/"><strong>Deserialization</strong></a>****</li>
<li>****<a href="../../pentesting-web/email-header-injection.md"><strong>Email Header Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/file-inclusion.md"><strong>File Inclusion</strong></a>****</li>
<li>****<a href="../../pentesting-web/file-upload/"><strong>File Upload</strong></a>****</li>
<li>****<a href="../../pentesting-web/idor.md"><strong>IDOR</strong></a>****</li>
<li>****<a href="../../pentesting-web/hacking-jwt-json-web-tokens.md"><strong>JWT Vulnerabilities</strong></a>****</li>
<li>****<a href="../../pentesting-web/nosql-injection.md"><strong>NoSQL Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/ldap-injection.md"><strong>LDAP Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/open-redirect.md"><strong>Open Redirect</strong></a></li>
<li><a href="../../pentesting-web/race-condition.md"><strong>Race Condition</strong></a>****</li>
<li>****<a href="../../pentesting-web/sql-injection/"><strong>SQL Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/ssrf-server-side-request-forgery.md"><strong>SSRF (Server Side Request Forgery)</strong></a>****</li>
<li>****<a href="../../pentesting-web/ssti-server-side-template-injection.md"><strong>SSTI (Server Side Template Injection)</strong></a>****</li>
<li>****<a href="../../pentesting-web/unicode-normalization-vulnerability.md"><strong>Unicode Normalization vulnerability</strong></a>****</li>
<li>****<a href="../../pentesting-web/xpath-injection.md"><strong>XPATH Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/xslt-server-side-injection-extensible-stylesheet-languaje-transformations.md"><strong>XSLT Server Side Injection</strong></a>****</li>
<li>****<a href="../../pentesting-web/xxe-xee-xml-external-entity.md"><strong>XXE (XML External Entity)</strong></a>****</li>
<li>****<a href="../../pentesting-web/xss-cross-site-scripting/"><strong>XSS (Cross Site Scripting)</strong></a>****</li>
<li>****<a href="../../pentesting-web/xs-search.md"><strong>XS-Search</strong></a>****</li>
</ul>
<p><strong>More references</strong> for each Web Vulnerability: <a href="https://cyberzombie.in/bug-bounty-methodology-techniques-tools-procedures/" target="_blank" rel="noopener">https://cyberzombie.in/bug-bounty-methodology-techniques-tools-procedures/</a></p>
