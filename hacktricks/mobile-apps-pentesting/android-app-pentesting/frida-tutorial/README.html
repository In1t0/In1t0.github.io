<h1 id="Frida-Tutorial"><a href="#Frida-Tutorial" class="headerlink" title="Frida Tutorial"></a>Frida Tutorial</h1><h2 id="Installation"><a href="#Installation" class="headerlink" title="Installation"></a>Installation</h2><p>Install <strong>frida tools</strong>:</p>
<pre><code class="bash">pip install frida-tools
pip install frida
</code></pre>
<p><strong>Download and install</strong> in the android the <strong>frida server</strong> (<a href="https://github.com/frida/frida/releases" target="_blank" rel="noopener">Download the latest release</a>).<br>One-liner to restart adb in root mode, connect to it, upload frida-server, give exec permissions and run it in backgroud:</p>
<pre><code class="bash">adb root; adb connect localhost:6000; sleep 1; adb push frida-server /data/local/tmp/; adb shell &quot;chmod 755 /data/local/tmp/frida-server&quot;; adb shell &quot;/data/local/tmp/frida-server &amp;&quot; 
</code></pre>
<p><strong>Check</strong> if it is <strong>working</strong>:</p>
<pre><code class="bash">frida-ps -U #List packages and processes
frida-ps -U | grep -i &lt;part_of_the_package_name&gt; #Get all the package name
</code></pre>
<h2 id="Tutorials"><a href="#Tutorials" class="headerlink" title="Tutorials"></a>Tutorials</h2><h3 id="Tutorial-1"><a href="#Tutorial-1" class="headerlink" title="Tutorial 1"></a><a href="frida-tutorial-1.md">Tutorial 1</a></h3><p><strong>From</strong>: <a href="https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1" target="_blank" rel="noopener">https://medium.com/infosec-adventures/introduction-to-frida-5a3f51595ca1</a><br><strong>APK</strong>: <a href="https://github.com/t0thkr1s/frida-demo/releases" target="_blank" rel="noopener">https://github.com/t0thkr1s/frida-demo/releases</a><br><strong>Source Code</strong>: <a href="https://github.com/t0thkr1s/frida-demo" target="_blank" rel="noopener">https://github.com/t0thkr1s/frida-demo</a></p>
<p>Follow the <a href="frida-tutorial-1.md">link to read it</a>.</p>
<h3 id="Tutorial-2"><a href="#Tutorial-2" class="headerlink" title="Tutorial 2"></a><a href="frida-tutorial-2.md">Tutorial 2</a></h3><p><strong>From</strong>: <a href="https://11x256.github.io/Frida-hooking-android-part-2/" target="_blank" rel="noopener">https://11x256.github.io/Frida-hooking-android-part-2/</a> (Parts 2, 3 &amp; 4)<br><strong>APKs and Source code</strong>: <a href="https://github.com/11x256/frida-android-examples" target="_blank" rel="noopener">https://github.com/11x256/frida-android-examples</a></p>
<p>Follow the<a href="frida-tutorial-2.md"> link to read it.</a></p>
<h3 id="Tutorial-3"><a href="#Tutorial-3" class="headerlink" title="Tutorial 3"></a><a href="owaspuncrackable-1.md">Tutorial 3</a></h3><p><strong>From</strong>: <a href="https://joshspicer.com/android-frida-1" target="_blank" rel="noopener">https://joshspicer.com/android-frida-1</a><br><strong>APK</strong>: <a href="https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level_01/UnCrackable-Level1.apk" target="_blank" rel="noopener">https://github.com/OWASP/owasp-mstg/blob/master/Crackmes/Android/Level_01/UnCrackable-Level1.apk</a></p>
<p>Follow the <a href="owaspuncrackable-1.md">link to read it</a>.<br><strong>You can find some Awesome Frida scripts here:</strong> <a href="https://codeshare.frida.re/" target="_blank" rel="noopener"><strong>https://codeshare.frida.re/</strong></a>****</p>
<h2 id="Fast-Examples"><a href="#Fast-Examples" class="headerlink" title="Fast Examples"></a>Fast Examples</h2><p>Here you can find the more basic and interesting functionalities of Frida to make a quick script:</p>
<h3 id="Calling-Frida-from-command-line"><a href="#Calling-Frida-from-command-line" class="headerlink" title="Calling Frida from command line"></a>Calling Frida from command line</h3><pre><code class="bash">frida-ps -U

#Basic frida hooking
frida -l disableRoot.js -f owasp.mstg.uncrackable1

#Hooking before starting the app
frida -U --no-pause -l disableRoot.js -f owasp.mstg.uncrackable1
#The --no-pause and -f options allow the app to be spawned automatically,
#frozen so that the instrumentation can occur, and the automatically
#continue execution with our modified code.
</code></pre>
<h3 id="Basic-Python-Script"><a href="#Basic-Python-Script" class="headerlink" title="Basic Python Script"></a>Basic Python Script</h3><pre><code class="python">import frida, sys

jscode = open(sys.argv[0]).read()
process = frida.get_usb_device().attach(&#39;infosecadventures.fridademo&#39;)
script = process.create_script(jscode)
print(&#39;[ * ] Running Frida Demo application&#39;)
script.load()
sys.stdin.read()
</code></pre>
<h3 id="Hooking-functions-without-parameters"><a href="#Hooking-functions-without-parameters" class="headerlink" title="Hooking functions without parameters"></a>Hooking functions without parameters</h3><p>Hook the function <code>a()</code> of the class <code>sg.vantagepoint.a.c</code></p>
<pre><code class="javascript">Java.perform(function () {
;  rootcheck1.a.overload().implementation = function() {
  rootcheck1.a.overload().implementation = function() {
    send(&quot;sg.vantagepoint.a.c.a()Z   Root check 1 HIT!  su.exists()&quot;);
    return false;
  };
});
</code></pre>
<p>Hook java <code>exit()</code></p>
<pre><code class="javascript">var sysexit = Java.use(&quot;java.lang.System&quot;);
  sysexit.exit.overload(&quot;int&quot;).implementation = function(var_0) {
    send(&quot;java.lang.System.exit(I)V  // We avoid exiting the application  :)&quot;);
  };
</code></pre>
<p>Hook MainActivity <code>.onStart()</code> &amp; <code>.onCreate()</code></p>
<pre><code class="javascript">var mainactivity = Java.use(&quot;sg.vantagepoint.uncrackable1.MainActivity&quot;);
  mainactivity.onStart.overload().implementation = function() {
    send(&quot;MainActivity.onStart() HIT!!!&quot;);
    var ret = this.onStart.overload().call(this);
  };
  mainactivity.onCreate.overload(&quot;android.os.Bundle&quot;).implementation = function(var_0) {
    send(&quot;MainActivity.onCreate() HIT!!!&quot;);
    var ret = this.onCreate.overload(&quot;android.os.Bundle&quot;).call(this,var_0);
  };
</code></pre>
<p>Hook android <code>.onCreate()</code></p>
<pre><code class="javascript">  var activity = Java.use(&quot;android.app.Activity&quot;);
  activity.onCreate.overload(&quot;android.os.Bundle&quot;).implementation = function(var_0) {
    send(&quot;Activity HIT!!!&quot;);
    var ret = this.onCreate.overload(&quot;android.os.Bundle&quot;).call(this,var_0);
  };
</code></pre>
<h3 id="Hooking-functions-with-parameters-and-retrieving-the-value"><a href="#Hooking-functions-with-parameters-and-retrieving-the-value" class="headerlink" title="Hooking functions with parameters and retrieving the value"></a>Hooking functions with parameters and retrieving the value</h3><p> Hooking a decryption function. Print the input, call the original function decrypt the input and finally, print the plain data:</p>
<pre><code class="javascript">  function getString(data){
      var ret = &quot;&quot;;
      for (var i=0; i &lt; data.length; i++){
          ret += data[i].toString();
        }
      return ret
    } 
  var aes_decrypt = Java.use(&quot;sg.vantagepoint.a.a&quot;);
  aes_decrypt.a.overload(&quot;[B&quot;,&quot;[B&quot;).implementation = function(var_0,var_1) {
    send(&quot;sg.vantagepoint.a.a.a([B[B)[B   doFinal(enc)  // AES/ECB/PKCS7Padding&quot;);
    send(&quot;Key       : &quot; + getString(var_0));
    send(&quot;Encrypted : &quot; + getString(var_1));
    var ret = this.a.overload(&quot;[B&quot;,&quot;[B&quot;).call(this,var_0,var_1);
    send(&quot;Decrypted : &quot; + ret);

    var flag = &quot;&quot;;
    for (var i=0; i &lt; ret.length; i++){
      flag += String.fromCharCode(ret[i]);
    }
    send(&quot;Decrypted flag: &quot; + flag);
    return ret; //[B
  };
</code></pre>
<h3 id="Hooking-functions-and-calling-them-with-our-input"><a href="#Hooking-functions-and-calling-them-with-our-input" class="headerlink" title="Hooking functions and calling them with our input"></a>Hooking functions and calling them with our input</h3><p>Hook a function that receives a string and call it with other string (from <a href="https://11x256.github.io/Frida-hooking-android-part-2/" target="_blank" rel="noopener">here</a>)</p>
<pre><code class="javascript">var string_class = Java.use(&quot;java.lang.String&quot;); // get a JS wrapper for java&#39;s String class

my_class.fun.overload(&quot;java.lang.String&quot;).implementation = function(x){ //hooking the new function
  var my_string = string_class.$new(&quot;My TeSt String#####&quot;); //creating a new String by using `new` operator 
  console.log(&quot;Original arg: &quot; +x );
  var ret =  this.fun(my_string); // calling the original function with the new String, and putting its return value in ret variable
  console.log(&quot;Return value: &quot;+ret);
  return ret;
};
</code></pre>
<h3 id="Getting-an-already-created-object-of-a-class"><a href="#Getting-an-already-created-object-of-a-class" class="headerlink" title="Getting an already created object of a class"></a>Getting an already created object of a class</h3><p>If you want to extract some attribute of a created object you can use this.</p>
<p>In this example you are going to see how to get the object of the class my_activity and how to call the function .secret() that will print a private attribute of the object:</p>
<pre><code class="javascript">Java.choose(&quot;com.example.a11x256.frida_test.my_activity&quot; , {
  onMatch : function(instance){ //This function will be called for every instance found by frida
    console.log(&quot;Found instance: &quot;+instance);
    console.log(&quot;Result of secret func: &quot; + instance.secret());
  },
  onComplete:function(){}
});
</code></pre>
